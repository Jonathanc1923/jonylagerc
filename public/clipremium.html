<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jony Lager - CliPremium</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700;900&family=Roboto:wght@300;400&display=swap" rel="stylesheet">

    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest"> <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#ffc107"> <link rel="shortcut icon" href="/favicon.ico">
    <meta name="msapplication-TileColor" content="#1a1a1a"> 
    <meta name="msapplication-config" content="/browserconfig.xml"> <meta name="theme-color" content="#1a1a1a">
    <link rel="stylesheet" href="css/estilo.css">

    <style>
        /* Estilos Específicos para la página clipremium.html */
        .clipremium-container {
            padding-top: calc(var(--separacion) / 2);
            padding-bottom: var(--separacion);
            min-height: calc(100vh - var(--header-height-desktop) - 150px);
        }

        @media (max-width: 768px) {
            .clipremium-container {
                min-height: calc(100vh - var(--header-height-mobile) - 120px);
            }
        }
        #clipremium-login-section {
            text-align: center;
            padding-bottom: var(--separacion);
        }
        #clipremium-gallery-section {
            text-align: center;
        }

        .login-form-wrapper { max-width: 450px; margin: 3rem auto; padding: 2.5rem 3rem; background-color: var(--color-secundario); border-radius: 12px; box-shadow: 0 8px 25px rgba(0,0,0,0.3); text-align: center; }
        .login-form-wrapper h2 { color: var(--color-acento); margin-bottom: 2rem; font-size: 2.8rem; }
        .login-form-wrapper label { display: block; text-align: left; margin-bottom: 0.8rem; color: var(--color-texto-secundario); font-size: 1.5rem; font-weight: bold; }
        .login-form-wrapper input[type="text"], .login-form-wrapper input[type="password"] { width: 100%; padding: 1.2rem 1.5rem; margin-bottom: 1.8rem; border: 1px solid #4a4a4a; border-radius: 6px; background-color: #383838; color: var(--color-texto-principal); font-size: 1.6rem; box-sizing: border-box; }
        .login-form-wrapper input[type="text"]:focus, .login-form-wrapper input[type="password"]:focus { outline: none; border-color: var(--color-acento); box-shadow: 0 0 0 3px rgba(255,193,7,0.3); }
        .login-form-wrapper button { display: inline-block; background-color: var(--color-acento); color: var(--color-primario); padding: 1.2rem 3rem; border: none; border-radius: 6px; font-family: var(--fuente-titulos); font-weight: 700; font-size: 1.7rem; text-transform: uppercase; cursor: pointer; transition: background-color 0.3s ease, transform 0.2s ease; width: 100%; }
        .login-form-wrapper button:hover { background-color: var(--color-acento-hover); transform: translateY(-2px); }
        .login-form-wrapper button:disabled { background-color: #555; cursor: not-allowed; transform: translateY(0); }
        .login-error-message { color: #ff6b6b; margin-top: 1.5rem; font-weight: bold; min-height: 1.5em; }

        /* --- Estilos para el título y botones de la barra de herramientas de edición --- */
        #editor-toolbar { 
            align-items: center !important; 
            gap: 12px !important; /* AUMENTADO el espacio entre todos los elementos de la barra */
            padding: 10px 12px !important; /* Un poco más de padding general para la barra */
        }

        .toolbar-title {
            display: flex;
            align-items: center;
            padding: 0px 10px; /* Un poco más de padding interno para el título */
            color: var(--color-acento); 
            font-family: var(--fuente-parrafos); 
            font-size: 1.5rem; /* AUMENTADO tamaño de fuente del título */
            font-weight: bold;
            white-space: nowrap; 
            margin-right: auto; 
        }

        .toolbar-title-icon {
            width: 22px; /* AUMENTADO tamaño del icono del título */
            height: 22px; /* AUMENTADO tamaño del icono del título */
            fill: currentColor; 
            margin-right: 8px; /* AUMENTADO espacio del icono del título */
        }

        .toolbar-title-text {
            line-height: 1; 
        }

        /* Sobrescribir o definir estilos para .tool-button específicamente para esta página si es necesario */
        /* Estos estilos modificarán los de estilo.css para los botones dentro de #editor-toolbar */
        #editor-toolbar .tool-button {
            padding: 8px; /* AUMENTADO padding del botón */
            font-size: 1.1rem; /* AUMENTADO tamaño de fuente del texto del botón */
            min-width: 70px; /* AUMENTADO ancho mínimo del botón */
        }
        #editor-toolbar .tool-button svg {
            width: 24px; /* AUMENTADO tamaño del icono del botón */
            height: 24px; /* AUMENTADO tamaño del icono del botón */
            margin-bottom: 4px; /* Un poco más de espacio bajo el icono */
        }
        #editor-toolbar .tool-button span {
             /* El span ya se oculta en móvil por estilo.css, aquí podemos asegurar visibilidad en desktop */
            display: inline;
        }


        @media (max-width: 768px) { 
            #editor-toolbar {
                gap: 6px !important; /* Ajustar gap para pantallas medianas */
                padding: 8px 10px !important;
            }
            .toolbar-title {
                font-size: 1.3rem; /* Mantenemos el ajuste previo */
                padding: 0px 4px;
            }
            .toolbar-title-icon {
                width: 18px; /* Mantenemos el ajuste previo */
                height: 18px;
            }
            /* Los estilos de .tool-button y su svg para 768px ya están en estilo.css global */
            /* Si necesitas que sean más grandes aquí específicamente, puedes añadir: */
            /* #editor-toolbar .tool-button { min-width: 50px; padding: 6px;} */
            /* #editor-toolbar .tool-button svg { width: 20px; height: 20px; } */
        }

        @media (max-width: 480px) {
             .toolbar-title {
                margin-right: 8px; 
                /* font-size: 1.2rem;  */ /* Ligeramente más pequeño si es necesario */
                /* Si quieres ocultar el texto y dejar solo el icono en pantallas muy pequeñas: */
                /* .toolbar-title-text { display: none; } */
             }
             #editor-toolbar {
                gap: 4px !important; /* Ajustar gap para pantallas pequeñas */
             }
             /* Los estilos de .tool-button y su svg para 480px ya están en estilo.css global */
             /* #editor-toolbar .tool-button { min-width: 45px; } */
        }
    </style>
</head>
<body class="clipremium-body">

    <header class="site-header">
        <div class="contenedor contenido-header">
            <div class="logo">
                <a href="index.html"><img src="img/logojonylager.png" alt="Logo Jony Lager"></a>
            </div>
            <button class="menu-toggle" aria-label="Abrir menú" aria-expanded="false" aria-controls="navegacionPrincipalPageClipremium">
                <span class="bar"></span><span class="bar"></span><span class="bar"></span>
            </button>
            <nav class="navegacion-principal" id="navegacionPrincipalPageClipremium">
                <a href="index.html">Inicio</a>
                <a href="servicios.html">Servicios</a>
                <a href="promociones.html">Promociones</a>
                <a href="clipremium.html" class="activo">CliPremium</a>
                <a href="contactanos.html">Contáctanos</a>
            </nav>
        </div>
    </header>

    <main class="contenedor contenido-principal clipremium-container">
        <section id="clipremium-login-section">
            <div class="login-form-wrapper">
                <h2>Acceso Exclusivo Clientes</h2>
                <form id="loginClienteForm">
                    <div>
                        <label for="nombreUsuarioGaleria">Usuario de Galería:</label>
                        <input type="text" id="nombreUsuarioGaleria" name="nombreUsuarioGaleria" required autocomplete="off">
                    </div>
                    <div>
                        <label for="codigoAccesoGaleria">Código de Acceso:</label>
                        <input type="password" id="codigoAccesoGaleria" name="codigoAccesoGaleria" required>
                    </div>
                    <button type="submit">Ingresar a mi Galería</button>
                    <p id="loginErrorMessage" class="login-error-message"></p>
                </form>
            </div>
        </section>

        <section id="clipremium-gallery-section" style="display:none;">
            <h2 id="gallery-title-premium">Tu Galería Privada</h2>
            <div id="gallery-container-premium" class="galeria-grid">
                </div>
        </section>
    </main>

    <footer class="site-footer">
         <div class="contenedor contenido-footer">
            <p>&copy; <span id="currentYearClipremium">2025</span> Jony Lager - Fotografía Exclusiva. Todos los derechos reservados.</p>
            <p>Arequipa, Perú.</p>
        </div>
    </footer>

    <div id="lightbox" class="lightbox">
        <span class="cerrar-lightbox">&times;</span>
        <span class="lightbox-control prev hidden">&#10094;</span>
        <span class="lightbox-control next hidden">&#10095;</span>
        <div class="lightbox-content">
            <img id="imagen-lightbox" src="" alt="Imagen ampliada">
            <div id="titulo-lightbox" class="titulo-lightbox"></div>
            
            <div id="editor-toolbar" class="editor-toolbar">
                <div class="toolbar-title">
                    <svg class="toolbar-title-icon" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                        <path d="M12.83 2.16L8.89 6.1L7.48 4.68L11.41 0.75C11.79 0.36 12.41 0.36 12.8 0.75L13.5 1.46C13.9 1.85 13.9 2.47 13.5 2.86L12.83 2.16ZM14.95 3.58L12.83 5.7L18.3 11.17L20.42 9.05C22.63 6.84 20.05 3.58 17.56 3.58C16.72 3.58 15.77 3.68 14.95 3.58ZM2.49 14.13L7.67 8.96L12.83 14.13L11.41 15.54L6.25 10.38L1.08 15.54C0.3 16.32 0.3 17.58 1.08 18.36L2.49 19.78C3.27 20.56 4.53 20.56 5.31 19.78L10.47 14.62L9.06 13.2L3.9 18.36C3.51 18.75 2.88 18.75 2.49 18.36L1.08 16.95C0.69 16.56 0.69 15.93 1.08 15.54L2.49 14.13ZM19.78 12.59L14.21 18.16L15.62 19.57L21.19 14C21.19 14 21.19 13.79 21.19 13.79C21.19 13.29 20.78 12.59 19.78 12.59Z M5.5 21H18.5C18.5 22.1 17.6 23 16.5 23H7.5C6.4 23 5.5 22.1 5.5 21Z"/>
                    </svg>
                    <span class="toolbar-title-text">¡Personaliza tu foto!</span>
                </div>
                <button class="tool-button" id="tool-change-bg" title="Cambiar Fondo">
                    <svg viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.95-.49-7-3.85-7-7.93s3.05-7.44 7-7.93v15.86zm2-15.86c1.03.13 2 .45 2.87.93L15 5.07A9.01 9.01 0 0013 4.07v1.86zm0 3.73v3.3h3.34c.04-.5.06-1 .06-1.5-.73-1.63-2.07-3-3.4-4.04zM15 11h-2v2h2v-2zm-2 4h2v2.87c-1.24.63-2.6.96-4 .96-1.5 0-2.91-.4-4.14-1.1L8.2 16.5c.9.54 2.03.9 3.2.9v-2.4zm5.87-2.5c0 .82-.12 1.62-.35 2.37l1.45.87A8.94 8.94 0 0021 12.5h-2.13z"></path></svg>
                    <span>Probar otro fondo!</span>
                </button>

                <div class="filters-panel" id="backgrounds-panel-container">
                    </div>

                <button class="tool-button" id="tool-brightness" title="Brillo">
                    <svg viewBox="0 0 24 24" fill="currentColor"> <path d="M12 6c-3.31 0-6 2.69-6 6s2.69 6 6 6 6-2.69 6-6-2.69-6-6-6zm0 10c-2.21 0-4-1.79-4-4s1.79-4 4-4 4 1.79 4 4-1.79 4-4 4zM12 4V2M4.93 4.93l-1.41-1.41M20 12h2M4.93 19.07l-1.41 1.41M12 20v2M19.07 19.07l1.41-1.41M6.34 12H4.22m15.44 0h-2.12"/> </svg>
                    <span>Brillo</span>
                </button>
                <div class="slider-container" id="brightness-slider-container">
                    <input type="range" min="50" max="150" value="100" class="effect-slider" id="brightness-slider"> <span id="brightness-value">100%</span>
                </div>

                <button class="tool-button" id="tool-contrast" title="Contraste">
                    <svg viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm0-14c-3.31 0-6 2.69-6 6s2.69 6 6 6V6z"></path></svg>
                    <span>Contraste</span>
                </button>
                <div class="slider-container" id="contrast-slider-container">
                    <input type="range" min="50" max="200" value="100" class="effect-slider" id="contrast-slider">
                    <span id="contrast-value">100%</span>
                </div>

                <button class="tool-button" id="tool-saturation" title="Saturación">
                     <svg viewBox="0 0 24 24"><path d="M12 .9C5.88.9.9 5.88.9 12s4.98 11.1 11.1 11.1S23.1 18.12 23.1 12 .9 5.88.9 12zm0 2C6.98 2.9.9 8.98.9 12s2.02 9.1 9.1 9.1 9.1-2.02 9.1-9.1S17.02 2.9 12 2.9zm-.9 5.58c-1.68 0-3.04 1.36-3.04 3.04s1.36 3.04 3.04 3.04c1.1 0 2.08-.58 2.62-1.46l-1.48-.88c-.24.48-.72.8-1.14.8-.8 0-1.46-.66-1.46-1.46s.66-1.46 1.46-1.46c.42 0 .9.32 1.14.8l1.48-.88C13.18 9.06 12.2 8.48 11.1 8.48z"></path></svg>
                    <span>Saturación</span>
                </button>
                <div class="slider-container" id="saturation-slider-container">
                    <input type="range" min="0" max="200" value="100" class="effect-slider" id="saturation-slider">
                    <span id="saturation-value">100%</span>
                </div>
                
                <button class="tool-button" id="tool-filters" title="Filtros">
                    <svg viewBox="0 0 24 24"><path d="M10.08 0C4.51 0 0 4.51 0 10.08s4.51 10.08 10.08 10.08S20.16 15.65 20.16 10.08 15.65 0 10.08 0zm0 18.14A8.07 8.07 0 1110.08 2a8.07 8.07 0 010 16.14zM5.04 5.04h10.08v2.02H5.04V5.04zm0 4.03h10.08v2.02H5.04v-2.02zm0 4.04h6.05v2.01H5.04v-2.01z"></path></svg>
                    <span>Filtros</span>
                </button>
                <div class="filters-panel" id="filters-panel-container">
                    <button class="filter-option active-filter" data-filter="original">Original</button>
                    <button class="filter-option" data-filter="grayscale">B&N</button>
                    <button class="filter-option" data-filter="bw_intenso">B&N Intenso</button>
                    
                    <button class="filter-option" data-filter="vintage_suave">Vintage</button>
                    <button class="filter-option" data-filter="kodak_gold">Kodak Gold</button>
                    <button class="filter-option" data-filter="mate_look">Mate</button>
                    <button class="filter-option" data-filter="aden_filter">Aden</button>
                    <button class="filter-option" data-filter="valencia_filter">Valencia</button>
                    <button class="filter-option" data-filter="teal_orange">Teal & Orange</button>
                    
                    
                </div>
                
                <button class="tool-button" id="tool-reset" title="Restablecer">
                    <svg viewBox="0 0 24 24"><path d="M12 5V1L7 6l5 5V7c3.31 0 6 2.69 6 6s-2.69 6-6 6-6-2.69-6-6H4c0 4.42 3.58 8 8 8s8-3.58 8-8-3.58-8-8-8z"></path></svg>
                    <span>Restablecer</span>
                </button>
                 <button class="tool-button" id="lightbox-download-button" title="Descargar Imagen Editada">
                    <svg viewBox="0 0 24 24"><path d="M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96zM17 13l-5 5-5-5h3V9h4v4h3z"></path></svg>
                    <span>Descargar</span>
                </button>
            </div>
        </div>
    </div>

    <script src="js/script.js"></script>
    <script>
        // JavaScript específico para clipremium.html (para login y carga de galería)
        document.addEventListener('DOMContentLoaded', () => {
            const loginForm = document.getElementById('loginClienteForm');
            const loginSection = document.getElementById('clipremium-login-section');
            const gallerySection = document.getElementById('clipremium-gallery-section');
            const galleryContainer = document.getElementById('gallery-container-premium');
            const galleryTitleElement = document.getElementById('gallery-title-premium');
            const loginErrorMessageElement = document.getElementById('loginErrorMessage');
            
            const currentYearSpanClipremium = document.getElementById('currentYearClipremium');
            if (currentYearSpanClipremium) {
                currentYearSpanClipremium.textContent = new Date().getFullYear();
            }

            if (loginForm) {
                loginForm.addEventListener('submit', async (event) => {
                    event.preventDefault();
                    loginErrorMessageElement.textContent = '';
                    loginErrorMessageElement.style.display = 'none';

                    const nombreUsuario = document.getElementById('nombreUsuarioGaleria').value.trim();
                    const codigoAcceso = document.getElementById('codigoAccesoGaleria').value.trim();

                    if (!nombreUsuario || !codigoAcceso) {
                        loginErrorMessageElement.textContent = 'Por favor, ingresa tu usuario y código.';
                        loginErrorMessageElement.style.display = 'block';
                        return;
                    }

                    const submitButton = loginForm.querySelector('button[type="submit"]');
                    const originalButtonText = submitButton.textContent;
                    submitButton.textContent = 'Verificando...';
                    submitButton.disabled = true;

                    try {
                        const response = await fetch('/acceder-galeria-privada', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({
                                nombre_usuario_galeria: nombreUsuario,
                                codigo_acceso_galeria: codigoAcceso
                            }),
                        });
                        const data = await response.json();

                        if (response.ok && data.success) {
                            loginSection.style.display = 'none';
                            gallerySection.style.display = 'block';
                            galleryTitleElement.textContent = data.tituloGaleria || "Tu Galería de Recuerdos";
                            if (data.idAcceso) { 
                                window.idAccesoGaleriaCliente = data.idAcceso;
                                console.log("ID de Acceso guardado:", window.idAccesoGaleriaCliente);
                            }
                            displayImages(data.imagenes);
                        } else {
                            loginErrorMessageElement.textContent = data.message || 'Error de acceso. Verifica tus credenciales.';
                            loginErrorMessageElement.style.display = 'block';
                        }
                    } catch (error) {
                        console.error('Error en el proceso de login:', error);
                        loginErrorMessageElement.textContent = 'No se pudo conectar con el servidor. Intenta más tarde.';
                        loginErrorMessageElement.style.display = 'block';
                    } finally {
                        submitButton.textContent = originalButtonText;
                        submitButton.disabled = false;
                    }
                });
            }

            function displayImages(imagenes) {
                galleryContainer.innerHTML = '';
                if (!imagenes || imagenes.length === 0) {
                    galleryContainer.innerHTML = '<p style="color: var(--color-texto-secundario); font-size: 1.8rem;">No hay imágenes disponibles en esta galería.</p>';
                    return;
                }

                imagenes.forEach((imgData, index) => {
                    let viewUrl = typeof imgData === 'string' ? imgData : imgData.viewUrl;
                    let downloadUrl = typeof imgData === 'string' ? imgData : (imgData.downloadUrl || viewUrl);
                    let fileName = typeof imgData === 'string' ? `foto_cliente_${index + 1}.jpg` : (imgData.originalName || `foto_cliente_${index + 1}.jpg`);
                    let title = `Foto ${index + 1}` + (imgData.originalName ? ` - ${imgData.originalName}` : '');

                    const itemDiv = document.createElement('div');
                    itemDiv.className = 'item-galeria'; 

                    const lightboxLink = document.createElement('a');
                    lightboxLink.href = viewUrl;
                    lightboxLink.setAttribute('data-lightbox', 'clipremium-gallery'); 
                    lightboxLink.setAttribute('data-title', title);
                    lightboxLink.setAttribute('data-original-wasabi-url', viewUrl); 
                    lightboxLink.setAttribute('data-original-name', fileName);

                    const imgElement = document.createElement('img');
                    imgElement.src = viewUrl; 
                    imgElement.alt = title;
                    imgElement.onerror = () => { 
                        imgElement.alt = "Error al cargar imagen"; 
                        imgElement.style.display = 'none'; 
                        const errorText = document.createElement('p');
                        errorText.textContent = 'Error al cargar';
                        errorText.style.color = 'var(--color-texto-secundario)';
                        lightboxLink.appendChild(errorText);
                    };

                    lightboxLink.appendChild(imgElement);
                    itemDiv.appendChild(lightboxLink);

                    const downloadWrapper = document.createElement('div');
                    downloadWrapper.className = 'download-button-wrapper';

                    const downloadLinkElement = document.createElement('a');
                    downloadLinkElement.href = downloadUrl;
                    downloadLinkElement.className = 'download-button';
                    downloadLinkElement.setAttribute('download', fileName);
                    downloadLinkElement.innerHTML = `
                        <svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor" style="margin-right: 8px;"><path d="M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96zM17 13l-5 5-5-5h3V9h4v4h3z"></path></svg>
                        Descargar
                    `;
                    downloadWrapper.appendChild(downloadLinkElement);
                    itemDiv.appendChild(downloadWrapper);
                    galleryContainer.appendChild(itemDiv);
                });

                if (typeof window.inicializarLightboxGlobal === 'function') {
                    window.inicializarLightboxGlobal('#gallery-container-premium a[data-lightbox="clipremium-gallery"]');
                } else {
                    console.warn('Función global inicializarLightboxGlobal no encontrada.');
                }
            }
        });
    </script>
</body>
</html>